2025-11-03 21:28:29 - modules.ml_training_data_builder - INFO - 
============================================================

============================================================
2025-11-03 21:28:29 - modules.ml_training_data_builder - INFO - Building Training Dataset: passing_yards
Building Training Dataset: passing_yards
2025-11-03 21:28:29 - modules.ml_training_data_builder - INFO - Years: 2015-2024
Years: 2015-2024
2025-11-03 21:28:29 - modules.ml_training_data_builder - INFO - ============================================================
============================================================
2025-11-03 21:28:29 - modules.ml_training_data_builder - INFO - Eligible positions: ['QB']
Eligible positions: ['QB']
2025-11-03 21:28:29 - modules.ml_training_data_builder - INFO - Target stat column: passing_yards
Target stat column: passing_yards
2025-11-03 21:28:29 - modules.ml_training_data_builder - INFO - 
Processing 2015...

Processing 2015...
2025-11-03 21:28:29 - modules.ml_training_data_builder - INFO -   Loaded 602 QB records for 2015
  Loaded 602 QB records for 2015
2025-11-03 21:33:06 - modules.ml_training_data_builder - INFO -   QB: 493 examples
  QB: 493 examples
2025-11-03 21:33:06 - modules.ml_training_data_builder - INFO -   Generated 493 examples for 2015
  Generated 493 examples for 2015
2025-11-03 21:33:06 - modules.ml_training_data_builder - INFO - 
Processing 2016...

Processing 2016...
2025-11-03 21:33:06 - modules.ml_training_data_builder - INFO -   Loaded 598 QB records for 2016
  Loaded 598 QB records for 2016
2025-11-03 21:37:45 - modules.ml_training_data_builder - INFO -   QB: 493 examples
  QB: 493 examples
2025-11-03 21:37:45 - modules.ml_training_data_builder - INFO -   Generated 493 examples for 2016
  Generated 493 examples for 2016
2025-11-03 21:37:45 - modules.ml_training_data_builder - INFO - 
Processing 2017...

Processing 2017...
2025-11-03 21:37:45 - modules.ml_training_data_builder - INFO -   Loaded 592 QB records for 2017
  Loaded 592 QB records for 2017
2025-11-03 21:42:06 - modules.ml_training_data_builder - INFO -   QB: 488 examples
  QB: 488 examples
2025-11-03 21:42:06 - modules.ml_training_data_builder - INFO -   Generated 488 examples for 2017
  Generated 488 examples for 2017
2025-11-03 21:42:06 - modules.ml_training_data_builder - INFO - 
Processing 2018...

Processing 2018...
2025-11-03 21:42:06 - modules.ml_training_data_builder - INFO -   Loaded 602 QB records for 2018
  Loaded 602 QB records for 2018
2025-11-03 21:45:52 - modules.ml_training_data_builder - INFO -   QB: 493 examples
  QB: 493 examples
2025-11-03 21:45:52 - modules.ml_training_data_builder - INFO -   Generated 493 examples for 2018
  Generated 493 examples for 2018
2025-11-03 21:45:52 - modules.ml_training_data_builder - INFO - 
Processing 2019...

Processing 2019...
2025-11-03 21:45:52 - modules.ml_training_data_builder - INFO -   Loaded 589 QB records for 2019
  Loaded 589 QB records for 2019
2025-11-03 21:48:53 - modules.ml_training_data_builder - INFO -   QB: 478 examples
  QB: 478 examples
2025-11-03 21:48:53 - modules.ml_training_data_builder - INFO -   Generated 478 examples for 2019
  Generated 478 examples for 2019
2025-11-03 21:48:53 - modules.ml_training_data_builder - INFO - 
Processing 2020...

Processing 2020...
2025-11-03 21:48:53 - modules.ml_training_data_builder - INFO -   Loaded 622 QB records for 2020
  Loaded 622 QB records for 2020
2025-11-03 21:52:28 - modules.ml_training_data_builder - INFO -   QB: 514 examples
  QB: 514 examples
2025-11-03 21:52:28 - modules.ml_training_data_builder - INFO -   Generated 514 examples for 2020
  Generated 514 examples for 2020
2025-11-03 21:52:28 - modules.ml_training_data_builder - INFO - 
Processing 2021...

Processing 2021...
2025-11-03 21:52:28 - modules.ml_training_data_builder - INFO -   Loaded 655 QB records for 2021
  Loaded 655 QB records for 2021
2025-11-03 21:56:05 - modules.ml_training_data_builder - INFO -   QB: 542 examples
  QB: 542 examples
2025-11-03 21:56:05 - modules.ml_training_data_builder - INFO -   Generated 542 examples for 2021
  Generated 542 examples for 2021
2025-11-03 21:56:05 - modules.ml_training_data_builder - INFO - 
Processing 2022...

Processing 2022...
2025-11-03 21:56:05 - modules.ml_training_data_builder - INFO -   Loaded 633 QB records for 2022
  Loaded 633 QB records for 2022
2025-11-03 21:59:50 - modules.ml_training_data_builder - INFO -   QB: 526 examples
  QB: 526 examples
2025-11-03 21:59:50 - modules.ml_training_data_builder - INFO -   Generated 526 examples for 2022
  Generated 526 examples for 2022
2025-11-03 21:59:50 - modules.ml_training_data_builder - INFO - 
Processing 2023...

Processing 2023...
2025-11-03 21:59:50 - modules.ml_training_data_builder - INFO -   Loaded 663 QB records for 2023
  Loaded 663 QB records for 2023
2025-11-03 22:02:56 - modules.ml_training_data_builder - INFO -   QB: 551 examples
  QB: 551 examples
2025-11-03 22:02:56 - modules.ml_training_data_builder - INFO -   Generated 551 examples for 2023
  Generated 551 examples for 2023
2025-11-03 22:02:56 - modules.ml_training_data_builder - INFO - 
Processing 2024...

Processing 2024...
2025-11-03 22:02:56 - modules.ml_training_data_builder - INFO -   Loaded 664 QB records for 2024
  Loaded 664 QB records for 2024
2025-11-03 22:05:32 - modules.ml_training_data_builder - INFO -   QB: 546 examples
  QB: 546 examples
2025-11-03 22:05:32 - modules.ml_training_data_builder - INFO -   Generated 546 examples for 2024
  Generated 546 examples for 2024
2025-11-03 22:05:32 - modules.ml_training_data_builder - INFO - 
============================================================

============================================================
2025-11-03 22:05:32 - modules.ml_training_data_builder - INFO - Training Data Generation Complete
Training Data Generation Complete
2025-11-03 22:05:32 - modules.ml_training_data_builder - INFO - ============================================================
============================================================
2025-11-03 22:05:32 - modules.ml_training_data_builder - INFO - Total examples: 5,124
Total examples: 5,124
2025-11-03 22:05:32 - modules.ml_training_data_builder - INFO - Features per example: 24
Features per example: 24
2025-11-03 22:05:32 - modules.ml_training_data_builder - INFO - 
Skipped:

Skipped:
2025-11-03 22:05:32 - modules.ml_training_data_builder - INFO -   Early weeks (< week 4): 1,096
  Early weeks (< week 4): 1,096
2025-11-03 22:05:32 - modules.ml_training_data_builder - INFO -   Null targets: 0
  Null targets: 0
2025-11-03 22:05:32 - modules.ml_training_data_builder - INFO -   No opponent data: 0
  No opponent data: 0
2025-11-03 22:05:32 - modules.ml_training_data_builder - INFO -   Errors: 0
  Errors: 0
2025-11-03 22:05:32 - modules.ml_training_data_builder - INFO - 
Data Quality:

Data Quality:
2025-11-03 22:05:32 - modules.ml_training_data_builder - INFO - 
Saved to: C:\Users\nairs\Documents\GithubProjects\GridironMetrics\cache\ml_training_data\passing_yards_2015_2024.parquet

Saved to: C:\Users\nairs\Documents\GithubProjects\GridironMetrics\cache\ml_training_data\passing_yards_2015_2024.parquet
2025-11-03 22:05:32 - modules.ml_training_data_builder - INFO - File size: 0.1 MB
File size: 0.1 MB
2025-11-03 22:05:32 - modules.ml_ensemble - INFO - 
============================================================

============================================================
2025-11-03 22:05:32 - modules.ml_ensemble - INFO - Training Ensemble: passing_yards
Training Ensemble: passing_yards
2025-11-03 22:05:32 - modules.ml_ensemble - INFO - ============================================================
============================================================
2025-11-03 22:05:32 - modules.ml_ensemble - INFO - Training examples: 4,027
Training examples: 4,027
2025-11-03 22:05:32 - modules.ml_ensemble - INFO - CV splits: 3
CV splits: 3
2025-11-03 22:05:32 - modules.ml_ensemble - INFO - Numeric features: 22
Numeric features: 22
2025-11-03 22:05:32 - modules.ml_ensemble - INFO - Categorical features: 2
Categorical features: 2
2025-11-03 22:05:32 - modules.ml_ensemble - INFO - 
Cross-Validation:

Cross-Validation:
2025-11-03 22:05:32 - modules.ml_ensemble - INFO - 
  Fold 1/3:

  Fold 1/3:
2025-11-03 22:05:32 - modules.ml_ensemble - INFO -     Train: 1009, Val: 1006
    Train: 1009, Val: 1006
C:\Users\nairs\Documents\GithubProjects\GridironMetrics\.venv\Lib\site-packages\sklearn\utils\validation.py:2749: UserWarning: X does not have valid feature names, but LGBMRegressor was fitted with feature names
  warnings.warn(
2025-11-03 22:05:58 - modules.ml_ensemble - INFO - 
  Fold 2/3:

  Fold 2/3:
2025-11-03 22:05:58 - modules.ml_ensemble - INFO -     Train: 2015, Val: 1006
    Train: 2015, Val: 1006
C:\Users\nairs\Documents\GithubProjects\GridironMetrics\.venv\Lib\site-packages\sklearn\utils\validation.py:2749: UserWarning: X does not have valid feature names, but LGBMRegressor was fitted with feature names
  warnings.warn(
2025-11-03 22:06:21 - modules.ml_ensemble - INFO - 
  Fold 3/3:

  Fold 3/3:
2025-11-03 22:06:21 - modules.ml_ensemble - INFO -     Train: 3021, Val: 1006
    Train: 3021, Val: 1006
C:\Users\nairs\Documents\GithubProjects\GridironMetrics\.venv\Lib\site-packages\sklearn\utils\validation.py:2749: UserWarning: X does not have valid feature names, but LGBMRegressor was fitted with feature names
  warnings.warn(
2025-11-03 22:06:45 - modules.ml_ensemble - INFO - 
============================================================

============================================================
2025-11-03 22:06:45 - modules.ml_ensemble - INFO - Cross-Validation Results (Mean ± Std):
Cross-Validation Results (Mean ± Std):
2025-11-03 22:06:45 - modules.ml_ensemble - INFO - ============================================================
============================================================
2025-11-03 22:06:45 - modules.ml_ensemble - INFO - xgboost        : MAE=68.89±1.70, RMSE=87.08±2.06
xgboost        : MAE=68.89±1.70, RMSE=87.08±2.06
2025-11-03 22:06:45 - modules.ml_ensemble - INFO - lightgbm       : MAE=67.29±0.73, RMSE=85.34±1.01
lightgbm       : MAE=67.29±0.73, RMSE=85.34±1.01
2025-11-03 22:06:45 - modules.ml_ensemble - INFO - catboost       : MAE=66.38±1.62, RMSE=83.43±1.46
catboost       : MAE=66.38±1.62, RMSE=83.43±1.46
2025-11-03 22:06:45 - modules.ml_ensemble - INFO - random_forest  : MAE=66.48±1.18, RMSE=84.53±1.28
random_forest  : MAE=66.48±1.18, RMSE=84.53±1.28
2025-11-03 22:06:45 - modules.ml_ensemble - INFO - 
============================================================

============================================================
2025-11-03 22:06:45 - modules.ml_ensemble - INFO - Ensemble Weights (based on inverse MAE):
Ensemble Weights (based on inverse MAE):
2025-11-03 22:06:45 - modules.ml_ensemble - INFO - ============================================================
============================================================
2025-11-03 22:06:45 - modules.ml_ensemble - INFO - xgboost        : 0.2440
xgboost        : 0.2440
2025-11-03 22:06:45 - modules.ml_ensemble - INFO - lightgbm       : 0.2498
lightgbm       : 0.2498
2025-11-03 22:06:45 - modules.ml_ensemble - INFO - catboost       : 0.2533
catboost       : 0.2533
2025-11-03 22:06:45 - modules.ml_ensemble - INFO - random_forest  : 0.2529
random_forest  : 0.2529
2025-11-03 22:06:45 - modules.ml_ensemble - INFO - 
============================================================

============================================================
2025-11-03 22:06:45 - modules.ml_ensemble - INFO - Training final models on full dataset...
Training final models on full dataset...
2025-11-03 22:06:45 - modules.ml_ensemble - INFO - ============================================================
============================================================
2025-11-03 22:06:45 - modules.ml_ensemble - INFO -   Training xgboost...
  Training xgboost...
2025-11-03 22:06:45 - modules.ml_ensemble - INFO -   Training lightgbm...
  Training lightgbm...
2025-11-03 22:06:45 - modules.ml_ensemble - INFO -   Training catboost...
  Training catboost...
2025-11-03 22:07:07 - modules.ml_ensemble - INFO -   Training random_forest...
  Training random_forest...
2025-11-03 22:07:08 - modules.ml_ensemble - INFO - 
Ensemble training complete!

Ensemble training complete!
C:\Users\nairs\Documents\GithubProjects\GridironMetrics\.venv\Lib\site-packages\sklearn\utils\validation.py:2749: UserWarning: X does not have valid feature names, but LGBMRegressor was fitted with feature names
  warnings.warn(
C:\Users\nairs\Documents\GithubProjects\GridironMetrics\.venv\Lib\site-packages\sklearn\utils\validation.py:2749: UserWarning: X does not have valid feature names, but LGBMRegressor was fitted with feature names
  warnings.warn(

================================================================================
ML MODEL MULTI-YEAR EVALUATION
================================================================================

Training: 2015-2022
Testing: 2023 & 2024

Loading data...
Years available: [2015, 2016, 2017, 2018, 2019, 2020, 2021, 2022, 2023]

WARNING: 2024 data not found in training dataset
Regenerating training data to include 2024...

Generating 2015-2024 training data...

Dataset Split:
  Train (2015-2022): 4,027 examples
  Test 2023:         551 examples
  Test 2024:         546 examples
  Total test:        1,097 examples

================================================================================
TRAINING MODEL (2015-2022)
================================================================================

Model trained. Generating predictions...

================================================================================
TESTING ON 2023
================================================================================
Test examples: 551

Prediction Accuracy:
  MAE:  66.98 yards
  RMSE: 83.20 yards

Betting Performance:
  Accuracy: 53.2%
  Break-even: 52.4%
  Edge: +0.8%
  ROI: +1.52%

Confidence Levels:
  Level 1 (edge: 14.2 yards): 48.6% (138 bets)
  Level 2 (edge: 42.2 yards): 51.8% (137 bets)
  Level 3 (edge: 74.8 yards): 55.1% (138 bets)
  Level 4 (edge: 137.3 yards): 57.2% (138 bets)

================================================================================
TESTING ON 2024
================================================================================
Test examples: 546

Prediction Accuracy:
  MAE:  65.95 yards
  RMSE: 82.73 yards

Betting Performance:
  Accuracy: 50.7%
  Break-even: 52.4%
  Edge: -1.7%
  ROI: -3.15%

Confidence Levels:
  Level 1 (edge: 15.2 yards): 49.6% (137 bets)
  Level 2 (edge: 41.7 yards): 52.9% (136 bets)
  Level 3 (edge: 72.4 yards): 48.5% (136 bets)
  Level 4 (edge: 135.1 yards): 51.8% (137 bets)

================================================================================
COMBINED RESULTS (2023 + 2024)
================================================================================

Total Test Examples: 1,097

Prediction Accuracy:
  MAE:  66.46 yards
  RMSE: 82.97 yards

Betting Performance:
  Accuracy: 53.0%
  Wins: 581 / 1097
  ROI: +1.11%

================================================================================
SELECTIVE BETTING ANALYSIS
================================================================================

Testing different confidence thresholds:

Threshold    Accuracy     # Bets       ROI          Status      
----------------------------------------------------------------------
 20 yards       53.0%         907        +1.24%      PROFITABLE
 30 yards       53.5%         798        +2.15%      PROFITABLE
 40 yards       54.2%         699        +3.51%      PROFITABLE
 50 yards       55.9%         590        +6.78%      PROFITABLE
 60 yards       57.2%         507        +9.20%      PROFITABLE
 70 yards       57.6%         434        +9.97%      PROFITABLE
 80 yards       58.5%         371       +11.66%      PROFITABLE
 90 yards       57.2%         304        +9.27%      PROFITABLE
100 yards       56.1%         255        +7.06%      PROFITABLE
110 yards       58.5%         200       +11.68%      PROFITABLE
120 yards       58.4%         154       +11.57%      PROFITABLE

================================================================================
OPTIMAL THRESHOLD RANGES
================================================================================

Found 1 profitable range(s):

Range 1: 20-120 yards
  Avg Accuracy: 56.3%
  Avg ROI: +7.41%
  Bets (at 20 yards): 907
  Peak: 110 yards (58.5% acc, +11.68% ROI, 200 bets)

================================================================================
STRATEGY RECOMMENDATIONS
================================================================================

1. CONSERVATIVE (High Accuracy, Low Volume)
   Threshold: 120+ yards
   Expected: 58.4% accuracy, +11.57% ROI
   Volume: ~154 bets/2 years (~4.5 bets/week)

2. BALANCED (Good Accuracy, Moderate Volume)
   Threshold: 70+ yards
   Expected: 57.6% accuracy, +9.97% ROI
   Volume: ~434 bets/2 years (~12.8 bets/week)

3. AGGRESSIVE (More Bets, Still Profitable)
   Threshold: 20+ yards
   Expected: 53.0% accuracy, +1.24% ROI
   Volume: ~907 bets/2 years (~26.7 bets/week)
Traceback (most recent call last):
  File "C:\Users\nairs\Documents\GithubProjects\GridironMetrics\scripts\evaluate_ml_model_multi_year.py", line 434, in <module>
    results = main()
  File "C:\Users\nairs\Documents\GithubProjects\GridironMetrics\scripts\evaluate_ml_model_multi_year.py", line 347, in main
    print(f"\n\U0001f4a1 Recommendation: Start with BALANCED strategy ({balanced_data['threshold']}+ yards)")
    ~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\nairs\AppData\Local\Programs\Python\Python313\Lib\encodings\cp1252.py", line 19, in encode
    return codecs.charmap_encode(input,self.errors,encoding_table)[0]
           ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
UnicodeEncodeError: 'charmap' codec can't encode character '\U0001f4a1' in position 2: character maps to <undefined>
